{% extends 'hosting/base.html' %}
{% load i18n static %}

{% block page %}
        <div class="row">
            <div class="col-xs-12">
                <div class="btn-group edit-buttons">
                    {% block profile_edit_buttons %}
                        {% if profile != user.profile %}
                            <a href="{% url 'postman_write' profile.user.username %}" class="btn btn-primary">
                                <span class="glyphicon glyphicon-send"></span>&nbsp; 
                                <strong>{% trans "Write message" %}</strong>
                            </a>
                        {% endif %}
                        {% if profile = user.profile or role = "admin" %}
                            {% if role = "admin" %}{% trans "Update user's details" as update_title %}{% endif %}
                            {% if profile = user.profile %}{% trans "Update my details" as update_title %}{% endif %}
                            <a href="{% url 'profile_edit' profile.pk profile.user.username|slugify %}"
                               class="btn btn-success"
                               title="{{ update_title }}">
                                <span class="glyphicon glyphicon-pencil"></span>
                                <span class="hidden-xs">{% trans "Update" %}</span>
                            </a>
                        {% endif %}
                    {% endblock %}
                </div>
            </div>
        </div>



    <div class="row owner">
        <div class="col-xs-3 col-md-2">
            <img src="{{ profile.avatar_url }}" />
        </div>
        <div class="col-xs-9 col-md-10">
            <h1><small>{{ profile.get_title_display }}</small> {{ profile }}</h1>
        </div>
        {% if profile.birth_date %}
            <div class="col-xs-8 col-sm-9">
                <p>
                    {% blocktrans with age=profile.age %}{{ age }} y.o.{% endblocktrans %}
                    &nbsp;
                    {% include 'hosting/snippets/checked.html' with object=profile %}
                </p>
            </div>
        {% endif %}
    </div>

    <hr />

    <h2 class="owner">{% trans "About me" %}</h2>
    {{ profile.description|linebreaks }}

    <hr />

    {% if places %}
        <h2 class="owner">
            {% if places.len == is_hosting %}
                {% blocktrans count counter=places|length trimmed %}
                    Place
                {% plural %}
                    Places
                {% endblocktrans %}
            {% else %}
                {% blocktrans count counter=places|length trimmed %}
                    Habitat
                {% plural %}
                    Habitats
                {% endblocktrans %}
            {% endif %}
        </h2>
    {% endif %}
    {% for place in places %}
        <ul class="list-group">
            <li class="list-group-item {% if user.is_staff and place.checked %}alert-success{% endif %}">
                <div class="btn-group pull-right">
                    {% block place_edit_buttons %}{% endblock %}
                    <a href="{% url 'place_detail' place.pk %}" class="btn btn-primary" title="{% trans "View details of this place" %}">
                        <span class="glyphicon glyphicon-arrow-right"></span>
                        <span class="hidden-xs">{% trans "View" %}</span>
                    </a>
                </div>
                {% if view.public_view %}
                    <div>
                        {% if place.city %}
                            <h3>{{ place.city }}</h3>
                        {% endif %}
                        {% if place.closest_city %}
                            <h4>
								<span class="glyphicon glyphicon-share-alt small"></span>
								{% blocktrans with closest_city=place.closest_city %}near {{ closest_city }}{% endblocktrans %}
							</h4>
                        {% endif %}
						{% if place.state_province %}
							<h4>{{ place.state_province }}</h4>
						{% endif %}
                        <h4>{{ place.country.name }}</h4>
                    </div>
                    {% include 'hosting/snippets/checked.html' with object=place %}
                {% else %}
                    <div>
                        {% if user.is_staff %}
                            <p>{% include 'hosting/snippets/checked.html' with object=place %}</p>
                        {% endif %}
                        <h3>{{ place.address.strip }}</h3>
                        <h4>{% include 'hosting/snippets/place_city_complete.html' with city=place.city closest_city=place.closest_city %}</h4>
						{% if place.state_province %}
							<h4>{{ place.state_province }}</h4>
						{% endif %}
                        <h4>{{ place.postcode }} {{ place.country.name }}</h4>
                    </div>
    
                    <ul class="list-group">
                        {% for member in place.family_members.all %}
                            <li class="list-group-item list-vertical-align">
                                {% block family_member_edit_buttons %}{% endblock %}
    
                                <p class="details">
                                    {{ member.icon }}
                                    <b class="member">{{ member }}</b>
                                    {% if member.age %}<em class="comment">({{ member.age }})</em>{% endif %}
                                </p>
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}

                {% block family_member_add_buttons %}{% endblock %}
            </li>
        </ul>
    {% endfor %}

    {% block place_add_buttons %}{% endblock %}

    {% if not view.public_view %}
        <hr />

        <h2 class="owner">{% trans "Phones" %}</h2>
        <ul class="list-group phone-list">
            {% for phone in phones %}
                <li class="list-group-item list-vertical-align">
                    {% block phone_edit_buttons %}{% endblock %}

                    <p class="details">
                        {{ phone.icon }}
                        <b class="number">{{ phone.number.as_international }}</b>
                        <br class="visible-xs-inline" />
                        <em class="comment">{{ phone.comments }}</em>
                    </p>
                </li>
            {% endfor %}
        </ul>
        {% block phone_add_buttons %}{% endblock %}
    {% endif %}
{% endblock page %}
